/*!
 * Application Insights JavaScript SDK - Channel, 2.5.5
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e.Microsoft=e.Microsoft||{},e.Microsoft.ApplicationInsights={}))}(this,function(e){"use strict";var i="function",a="object",t="undefined",s="prototype",o="hasOwnProperty";function n(){return typeof globalThis!==t&&globalThis?globalThis:typeof self!==t&&self?self:typeof window!==t&&window?window:typeof global!==t&&global?global:null}function r(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if(n!==a&&n!==i)throw new TypeError("Object prototype may only be an Object:"+e);function r(){}return r[s]=e,new r}function l(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object[s][o].call(t,i)&&(e[i]=t[i]);return e}var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[o](n)&&(e[n]=t[n])})(e,t)};var c,d,f,p,h,g,m,v,_=n()||{};d=function(e,t){function n(){this.constructor=e}u(e,t),e[s]=null===t?r(t):(n[s]=t[s],new n)},(c=_).__assign=c.__assign||Object.assign||l,c.__extends=c.__extends||d,__assign=_.__assign,__extends=_.__extends,(p=f=f||{})[p.LocalStorage=0]="LocalStorage",p[p.SessionStorage=1]="SessionStorage",(g=h=h||{})[g.Default=0]="Default",g[g.Required=1]="Required",g[g.Array=2]="Array",g[g.Hidden=4]="Hidden",(v=m=m||{})[v.AI=0]="AI",v[v.AI_AND_W3C=1]="AI_AND_W3C",v[v.W3C=2]="W3C";var y=2,I=a,S=s,x="window",b="document",C="JSON",N="crypto",w=n;function E(e){var t=w();return t&&t[e]?t[e]:e===x&&T()?window:null}function T(){return Boolean(typeof window===I&&window)}function A(){return T()?window:E(x)}function D(){return Boolean(typeof document===I&&document)?document:E(b)}function R(){return Boolean(typeof navigator===I&&navigator)?navigator:E("navigator")}function L(){return Boolean(typeof JSON===I&&JSON||null!==E(C))}function M(){return L()?JSON||E(C):null}var U="attachEvent",O="addEventListener",P="detachEvent",z="removeEventListener";function k(e,t){return typeof e===t}function F(e){return k(e,t)||e===undefined}function B(e){return F(e)||null===e}function q(e,t){return e&&Object[s].hasOwnProperty.call(e,t)}function G(e){return k(e,a)}function j(e){return k(e,i)}function H(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!B(e))try{B(e[O])?B(e[U])||(e[U]("on"+t,n),i=!0):(e[O](t,n,r),i=!0)}catch(a){}return i}function X(e,t,n,r){if(void 0===r&&(r=!1),!B(e))try{B(e[z])?B(e[P])||e[P]("on"+t,n):e[z](t,n,r)}catch(i){}}var K=(W.isDate=function(e){return"[object Date]"===Object[s].toString.call(e)},W.isString=function(e){return k(e,"string")},W.isNumber=function(e){return k(e,"number")},W.isBoolean=function(e){return k(e,"boolean")},W.disableCookies=function(){W._canUseCookies=!1},W.newGuid=function(){function n(){var e=E(N);return e?e.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(J,function(e){var t=0|n();return("x"===e?t:3&t|8).toString(16)})},W.toISOString=function(e){if(W.isDate(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},W.arrForEach=function(e,t,n){for(var r=e.length,i=0;i<r;++i)i in e&&t.call(n||e,e[i],i,e)},W.arrIndexOf=function(e,t,n){for(var r=e.length,i=n||0,a=Math.max(0<=i?i:r-Math.abs(i),0);a<r;a++)if(a in e&&e[a]===t)return a;return-1},W.arrMap=function(e,t,n){for(var r=e.length,i=n||e,a=new Array(r),s=0;s<r;s++)s in e&&(a[s]=t.call(i,e[s],e));return a},W.arrReduce=function(e,t,n){var r,i=e.length,a=0;if(3<=arguments.length)r=n;else{for(;a<i&&!(a in e);)a++;r=e[a++]}for(;a<i;)a in e&&(r=t(r,e[a],a,e)),a++;return r},W.strTrim=function(e){return W.isString(e)?e.replace(/^\s+|\s+$/g,""):e},W.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(j(e)||G(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)q(e,r)&&n.push(r);if(t)for(var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=i.length,s=0;s<a;s++)q(e,i[s])&&n.push(i[s]);return n},W.objDefineAccessors=function(e,t,n,r){var i=Object.defineProperty;if(i)try{var a={enumerable:!0,configurable:!0};return n&&(a.get=n),r&&(a.set=r),i(e,t,a),!0}catch(s){}return!1},W.addEventHandler=function(e,t){var n=!1,r=A();r&&(n=H(r,e,t),n=H(r.body,e,t)||n);var i=D();return i&&(n=Q.Attach(i,e,t)||n),n},W.isTypeof=k,W.isUndefined=F,W.isNullOrUndefined=B,W.hasOwnProperty=q,W.isFunction=j,W.isObject=G,W.objCreate=r,W);function W(){}var V,Y,J=/[xy]/g,Q=(Z.Attach=H,Z.AttachEvent=H,Z.Detach=X,Z.DetachEvent=X,Z);function Z(){}(Y=V=V||{})[Y.CRITICAL=1]="CRITICAL",Y[Y.WARNING=2]="WARNING";var $=1,ee=2,te=3,ne=4,re=5,ie=6,ae=7,se=12,oe=20,le=22,ue=23,ce=24,de=26,fe=28,pe=33,he=40,ge=41,me=42,ve=43,_e=46,ye=47,Ie=48,Se=49,xe=50,be=52,Ce=54,Ne=56,we=57,Ee=58,Te=61,Ae=64,De=66,Re=67,Le=68,Me=69,Ue=70,Oe=73,Pe=74,ze=(ke.sanitizeDiagnosticText=function(e){return e?'"'+e.replace(/\"/g,"")+'"':""},ke.dataType="MessageData",ke.AiNonUserActionablePrefix="AI (Internal): ",ke.AiUserActionablePrefix="AI: ",ke);function ke(e,t,n,r){void 0===n&&(n=!1),this.messageId=e,this.message=(n?ke.AiUserActionablePrefix:ke.AiNonUserActionablePrefix)+e;var i="";L()&&(i=M().stringify(r));var a=(t?" message:"+ke.sanitizeDiagnosticText(t):"")+(r?" props:"+ke.sanitizeDiagnosticText(i):"");this.message+=a}var Fe=(Be.prototype.throwInternal=function(e,t,n,r,i){void 0===i&&(i=!1);var a,s=new ze(t,n,i,r),o=this;if(o.enableDebugExceptions())throw s;!K.isUndefined(s)&&s&&(K.isUndefined(s.message)||(i?(a=+s.messageId,!o._messageLogged[a]&&o.consoleLoggingLevel()>=V.WARNING&&(o.warnToConsole(s.message),o._messageLogged[a]=!0)):o.consoleLoggingLevel()>=V.WARNING&&o.warnToConsole(s.message),o.logInternalMessage(e,s)))},Be.prototype.warnToConsole=function(e){!K.isUndefined(console)&&console&&(K.isFunction(console.warn)?console.warn(e):K.isFunction(console.log)&&console.log(e))},Be.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},Be.prototype.logInternalMessage=function(e,t){var n,r,i,a,s=this;s._areInternalMessagesThrottled()||(n=!0,r=s.AIInternalMessagePrefix+t.messageId,s._messageLogged[r]?n=!1:s._messageLogged[r]=!0,n&&(e<=s.telemetryLoggingLevel()&&(s.queue.push(t),s._messageCount++),s._messageCount===s.maxInternalMessageLimit()&&(a=new ze(ue,i="Internal events throttle limit per PageView reached for this app.",!1),s.queue.push(a),s.warnToConsole(i))))},Be.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},Be);function Be(e){this.queue=[],this.AIInternalMessagePrefix="AITR_",this._messageCount=0,this._messageLogged={},this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},K.isNullOrUndefined(e)||(K.isNullOrUndefined(e.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return e.loggingLevelConsole}),K.isNullOrUndefined(e.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return e.loggingLevelTelemetry}),K.isNullOrUndefined(e.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return e.maxMessageLimit}),K.isNullOrUndefined(e.enableDebugExceptions)||(this.enableDebugExceptions=function(){return e.enableDebugExceptions}))}var qe=K.isFunction,Ge=function(i,a){var s=this,o=null,l=qe(i.processTelemetry),u=qe(i.setNextPlugin);s._hasRun=!1,s.getPlugin=function(){return i},s.getNext=function(){return o},s.setNext=function(e){o=e},s.processTelemetry=function(e,t){if(t=t||a,i&&l){s._hasRun=!0;try{t.setNext(o),u&&i.setNextPlugin(o),o&&(o._hasRun=!1),i.processTelemetry(e,t)}catch(r){var n=o&&o._hasRun;o&&n||t.diagLog().throwInternal(V.CRITICAL,Oe,"Plugin ["+i.identifier+"] failed during processTelemetry - "+r),o&&!n&&o.processTelemetry(e,t)}}else o&&(s._hasRun=!0,o.processTelemetry(e,t))}},je=K.isNullOrUndefined;function He(e,t){var n=[];if(e&&0<e.length)for(var r=null,i=0;i<e.length;i++){var a,s=e[i];s&&K.isFunction(s.processTelemetry)&&(a=new Ge(s,t),n.push(a),r&&r.setNext(a),r=a)}return 0<n.length?n[0]:null}var Xe=function kr(e,a,n,t){var r,i,s,o,l,u=this,c=null;null!==t&&(e&&K.isFunction(e.getPlugin)?c=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var a=e.getPlugin();!i&&a!==n||(i=!0,r.push(a)),e=e.getNext()}return i||r.push(n),He(r,t)}(e,u,t||e.getPlugin()):t?(i=u,o=r=e,l=!1,(s=t)&&r&&(o=[],K.arrForEach(r,function(e){!l&&e!==s||(l=!0,o.push(e))})),s&&!l&&(o=o||[]).push(s),c=He(o,i)):K.isUndefined(t)&&(c=He(e,u))),u.core=function(){return n},u.diagLog=function(){return(n||{}).logger||new Fe(a||{})},u.getCfg=function(){return a},u.getExtCfg=function(e,t){var n,r;return void 0===t&&(t={}),!a||(r=a.extensionConfig)&&e&&(n=r[e]),n||t},u.getConfig=function(e,t,n){var r;void 0===n&&(n=!1);var i=u.getExtCfg(e,null);return i&&!je(i[t])?r=i[t]:a&&!je(a[t])&&(r=a[t]),je(r)?n:r},u.hasNext=function(){return null!=c},u.getNext=function(){return c},u.setNext=function(e){c=e},u.processNext=function(e){var t=c;t&&(c=t.getNext(),t.processTelemetry(e,u))},u.createNew=function(e,t){return void 0===e&&(e=null),new kr(e||c,a,n,t)}},Ke=K.isFunction,We="getPlugin",Ve=(Ye.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},Ye);function Ye(){var a=this,s=!1,o=null,l=null;a.core=null,a.diagLog=function(e){return a._getTelCtx(e).diagLog()},a.isInitialized=function(){return s},a.setInitialized=function(e){s=e},a.setNextPlugin=function(e){l=e},a.processNext=function(e,t){t?t.processNext(e):l&&Ke(l.processTelemetry)&&l.processTelemetry(e,null)},a._getTelCtx=function(e){void 0===e&&(e=null);var t,n=e;return n||(t=o||new Xe(null,{},a.core),n=l&&l[We]?t.createNew(null,l[We]):t.createNew(null,l)),n},a._baseTelInit=function(e,t,n,r){e&&(e.extensionConfig=e.extensionConfig||[]),!r&&t&&(r=t.getProcessTelContext().getNext());var i=l;l&&l[We]&&(i=l[We]()),a.core=t,o=new Xe(r,e,t,i),s=!0}}var Je=K.isFunction,Qe="processTelemetry",Ze="priority",$e="setNextPlugin",et="isInitialized";function tt(t,n){for(var e=[],r=null,i=t.getNext();i;){var a=i.getPlugin();a&&(r&&Je(r[$e])&&Je(a[Qe])&&r[$e](a),Je(a[et])&&a[et]()||e.push(a),r=a,i=i.getNext())}K.arrForEach(e,function(e){e.initialize(t.getCfg(),t.core(),n,t.getNext())})}function nt(e){return e.sort(function(e,t){var n=0,r=Je(t[Qe]);return Je(e[Qe])?n=r?e[Ze]-t[Ze]:1:r&&(n=-1),n})}var rt=500,it="Channel has invalid priority",at=K.arrForEach,st=K.objDefineAccessors;function ot(e,t){t&&0<t.length&&(t=t.sort(function(e,t){return e.priority-t.priority}),at(t,function(e){if(e.priority<rt)throw Error(it+e.identifier)}),e.push(t))}var lt,ut=(lt=Ve,__extends(ct,lt),ct.prototype.processTelemetry=function(t,n){var r=this;this._channelQueue&&at(this._channelQueue,function(e){0<e.length&&r._getTelCtx(n).createNew(e).processNext(t)})},ct.prototype.getChannelControls=function(){return this._channelQueue},ct.prototype.initialize=function(t,n,r){var e,i,a,s,o;this.isInitialized()||(lt.prototype.initialize.call(this,t,n,r),t.isCookieUseDisabled&&K.disableCookies(),e=this._channelQueue=(a=r,o=[],(i=(t||{}).channels)&&at(i,function(e){return ot(o,e)}),a&&(s=[],at(a,function(e){e.priority>rt&&s.push(e)}),ot(o,s)),o),at(e,function(e){return tt(new Xe(e,t,n),r)}))},ct._staticInit=(st(ct.prototype,"ChannelControls",ct.prototype.getChannelControls),void st(ct.prototype,"channelQueue",ct.prototype.getChannelControls)),ct);function ct(){var e=null!==lt&&lt.apply(this,arguments)||this;return e.identifier="ChannelControllerPlugin",e.priority=rt,e}var dt=K.arrForEach,ft=K.isNullOrUndefined,pt=(ht.prototype.initialize=function(e,t,r,n){var i=this;if(i.isInitialized())throw Error("Core should not be initialized more than once");if(!e||ft(e.instrumentationKey))throw Error("Please provide instrumentation key");i.config=e;var a=i._channelController;n=n||K.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),i._notificationManager=n,e.extensions=ft(e.extensions)?[]:e.extensions,(e.extensionConfig=ft(e.extensionConfig)?{}:e.extensionConfig).NotificationManager=n,r=r||K.objCreate({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),i.logger=r;var s=[];s.push.apply(s,t.concat(e.extensions)),s=nt(s);var o=[],l={};if(dt(s,function(e){if(ft(e)||ft(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,n=e.identifier;e&&t&&(ft(l[t])?l[t]=n:r.warnToConsole("Two extensions have same priority #"+t+" - "+l[t]+", "+n)),(!t||t<a.priority)&&o.push(e)}),s.push(a),o.push(a),s=nt(s),i._extensions=s,tt(new Xe([a],e,i),s),tt(new Xe(o,e,i),s),i._extensions=o,0===i.getTransmissionControls().length)throw new Error("No channels available");i._setInit(!0)},ht.prototype.getTransmissionControls=function(){return this._channelController.getChannelControls()},ht.prototype.track=function(e){var t=this;e.iKey||(e.iKey=t.config.instrumentationKey),e.time||(e.time=K.toISOString(new Date)),ft(e.ver)&&(e.ver="4.0"),t.isInitialized()?(0<t._eventQueue.length&&(dt(t._eventQueue,function(e){t.getProcessTelContext().processNext(e)}),t._eventQueue=[]),t.getProcessTelContext().processNext(e)):t._eventQueue.push(e)},ht.prototype.getProcessTelContext=function(){var e=this._extensions,t=e;return e&&0!==e.length||(t=[this._channelController]),new Xe(t,this.config,this)},ht);function ht(){var t=!1,e=this;e._extensions=new Array,e._channelController=new ut,e.isInitialized=function(){return t},e._setInit=function(e){t=e},e._eventQueue=[]}var gt=(mt.prototype.addNotificationListener=function(e){this.listeners.push(e)},mt.prototype.removeNotificationListener=function(e){for(var t=K.arrIndexOf(this.listeners,e);-1<t;)this.listeners.splice(t,1),t=K.arrIndexOf(this.listeners,e)},mt.prototype.eventsSent=function(t){for(var n=this,r=this,e=0;e<this.listeners.length;++e)!function(e){r.listeners[e].eventsSent&&setTimeout(function(){return n.listeners[e].eventsSent(t)},0)}(e)},mt.prototype.eventsDiscarded=function(t,n){for(var r=this,i=this,e=0;e<this.listeners.length;++e)!function(e){i.listeners[e].eventsDiscarded&&setTimeout(function(){return r.listeners[e].eventsDiscarded(t,n)},0)}(e)},mt.prototype.eventsSendRequest=function(n,r){for(var i=this,a=this,e=0;e<this.listeners.length;++e)!function(e){if(a.listeners[e].eventsSendRequest)if(r)setTimeout(function(){return i.listeners[e].eventsSendRequest(n,r)},0);else try{a.listeners[e].eventsSendRequest(n,r)}catch(t){}}(e)},mt);function mt(){this.listeners=[]}var vt;vt=pt,__extends(_t,vt),_t.prototype.initialize=function(e,t){var n=this;n._notificationManager=new gt,n.logger=new Fe(e),n.config=e,vt.prototype.initialize.call(this,e,t,n.logger,n._notificationManager)},_t.prototype.getTransmissionControls=function(){return vt.prototype.getTransmissionControls.call(this)},_t.prototype.track=function(e){if(null===e)throw this._notifyInvalidEvent(e),Error("Invalid telemetry item");this._validateTelemetryItem(e),vt.prototype.track.call(this,e)},_t.prototype.addNotificationListener=function(e){this._notificationManager&&this._notificationManager.addNotificationListener(e)},_t.prototype.removeNotificationListener=function(e){this._notificationManager&&this._notificationManager.removeNotificationListener(e)},_t.prototype.pollInternalLogs=function(r){var t=this,e=this.config.diagnosticLogInterval;return e&&0<e||(e=1e4),setInterval(function(){var n=t,e=n.logger?n.logger.queue:[];K.arrForEach(e,function(e){var t={name:r||"InternalMessageId: "+e.messageId,iKey:n.config.instrumentationKey,time:K.toISOString(new Date),baseType:ze.dataType,baseData:{message:e.message}};n.track(t)}),e.length=0},e)},_t.prototype._validateTelemetryItem=function(e){if(K.isNullOrUndefined(e.name))throw this._notifyInvalidEvent(e),Error("telemetry name required")},_t.prototype._notifyInvalidEvent=function(e){this._notificationManager&&this._notificationManager.eventsDiscarded([e],y)};function _t(){return vt.call(this)||this}var yt=(It.requestContextHeader="Request-Context",It.requestContextTargetKey="appId",It.requestContextAppIdFormat="appId=cid-v1:",It.requestIdHeader="Request-Id",It.traceParentHeader="traceparent",It.sdkContextHeader="Sdk-Context",It.sdkContextHeaderAppIdRequest="appId",It.requestContextHeaderLowerCase="request-context",It);function It(){}var St=(xt.sanitizeKeyAndAddUniqueness=function(e,t,n){var r=t.length,i=xt.sanitizeKey(e,t);if(i.length!==r){for(var a=0,s=i;n[s]!==undefined;)a++,s=i.substring(0,xt.MAX_NAME_LENGTH-3)+xt.padNumber(a);i=s}return i},xt.sanitizeKey=function(e,t){var n;return t&&(t=xt.trim(t.toString())).length>xt.MAX_NAME_LENGTH&&(n=t.substring(0,xt.MAX_NAME_LENGTH),e.throwInternal(V.WARNING,we,"name is too long.  It has been truncated to "+xt.MAX_NAME_LENGTH+" characters.",{name:t},!0)),n||t},xt.sanitizeString=function(e,t,n){var r;return void 0===n&&(n=xt.MAX_STRING_LENGTH),t&&(n=n||xt.MAX_STRING_LENGTH,(t=xt.trim(t)).toString().length>n&&(r=t.toString().substring(0,n),e.throwInternal(V.WARNING,Te,"string value is too long. It has been truncated to "+n+" characters.",{value:t},!0))),r||t},xt.sanitizeUrl=function(e,t){return xt.sanitizeInput(e,t,xt.MAX_URL_LENGTH,De)},xt.sanitizeMessage=function(e,t){var n;return t&&t.length>xt.MAX_MESSAGE_LENGTH&&(n=t.substring(0,xt.MAX_MESSAGE_LENGTH),e.throwInternal(V.WARNING,Ne,"message is too long, it has been truncated to "+xt.MAX_MESSAGE_LENGTH+" characters.",{message:t},!0)),n||t},xt.sanitizeException=function(e,t){var n;return t&&t.length>xt.MAX_EXCEPTION_LENGTH&&(n=t.substring(0,xt.MAX_EXCEPTION_LENGTH),e.throwInternal(V.WARNING,be,"exception is too long, it has been truncated to "+xt.MAX_EXCEPTION_LENGTH+" characters.",{exception:t},!0)),n||t},xt.sanitizeProperties=function(e,t){if(t){var n={};for(var r in t){var i=t[r];if(K.isObject(i)&&L())try{i=M().stringify(i)}catch(a){e.throwInternal(V.WARNING,Se,"custom property is not valid",{exception:a},!0)}i=xt.sanitizeString(e,i,xt.MAX_PROPERTY_LENGTH),n[r=xt.sanitizeKeyAndAddUniqueness(e,r,n)]=i}t=n}return t},xt.sanitizeMeasurements=function(e,t){if(t){var n={};for(var r in t){var i=t[r];n[r=xt.sanitizeKeyAndAddUniqueness(e,r,n)]=i}t=n}return t},xt.sanitizeId=function(e,t){return t?xt.sanitizeInput(e,t,xt.MAX_ID_LENGTH,Me).toString():t},xt.sanitizeInput=function(e,t,n,r){var i;return t&&(t=xt.trim(t)).length>n&&(i=t.substring(0,n),e.throwInternal(V.WARNING,r,"input is too long, it has been truncated to "+n+" characters.",{data:t},!0)),i||t},xt.padNumber=function(e){var t="00"+e;return t.substr(t.length-3)},xt.trim=function(e){return K.isString(e)?e.replace(/^\s+|\s+$/g,""):e},xt.MAX_NAME_LENGTH=150,xt.MAX_ID_LENGTH=128,xt.MAX_PROPERTY_LENGTH=8192,xt.MAX_STRING_LENGTH=1024,xt.MAX_URL_LENGTH=2048,xt.MAX_MESSAGE_LENGTH=32768,xt.MAX_EXCEPTION_LENGTH=32768,xt);function xt(){}var bt=R(),Ct=K.isString,Nt=null;var wt=(Et.createDomEvent=function(e){var t,n=null;return K.isFunction(Event)?n=new Event(e):(t=D())&&t.createEvent&&(n=t.createEvent("Event")).initEvent(e,!0,!0),n},Et.disableStorage=function(){Et._canUseLocalStorage=!1,Et._canUseSessionStorage=!1},Et._getLocalStorageObject=function(){return Et.canUseLocalStorage()?Et._getVerifiedStorageObject(f.LocalStorage):null},Et._getVerifiedStorageObject=function(e){var t,n,r=null;try{if(K.isNullOrUndefined(w()))return null;n=new Date,(r=e===f.LocalStorage?E("localStorage"):E("sessionStorage")).setItem(n.toString(),n.toString()),t=r.getItem(n.toString())!==n.toString(),r.removeItem(n.toString()),t&&(r=null)}catch(i){r=null}return r},Et.isInternalApplicationInsightsEndpoint=function(e){return-1!==Et._internalEndpoints.indexOf(e.toLowerCase())},Et.canUseLocalStorage=function(){return Et._canUseLocalStorage===undefined&&(Et._canUseLocalStorage=!!Et._getVerifiedStorageObject(f.LocalStorage)),Et._canUseLocalStorage},Et.getStorage=function(e,t){var n=Et._getLocalStorageObject();if(null!==n)try{return n.getItem(t)}catch(r){Et._canUseLocalStorage=!1,e.throwInternal(V.WARNING,$,"Browser failed read of local storage. "+Et.getExceptionName(r),{exception:Et.dump(r)})}return null},Et.setStorage=function(e,t,n){var r=Et._getLocalStorageObject();if(null!==r)try{return r.setItem(t,n),!0}catch(i){Et._canUseLocalStorage=!1,e.throwInternal(V.WARNING,te,"Browser failed write to local storage. "+Et.getExceptionName(i),{exception:Et.dump(i)})}return!1},Et.removeStorage=function(e,t){var n=Et._getLocalStorageObject();if(null!==n)try{return n.removeItem(t),!0}catch(r){Et._canUseLocalStorage=!1,e.throwInternal(V.WARNING,re,"Browser failed removal of local storage item. "+Et.getExceptionName(r),{exception:Et.dump(r)})}return!1},Et._getSessionStorageObject=function(){return Et.canUseSessionStorage()?Et._getVerifiedStorageObject(f.SessionStorage):null},Et.canUseSessionStorage=function(){return Et._canUseSessionStorage===undefined&&(Et._canUseSessionStorage=!!Et._getVerifiedStorageObject(f.SessionStorage)),Et._canUseSessionStorage},Et.getSessionStorageKeys=function(){var e=[];if(Et.canUseSessionStorage())for(var t in E("sessionStorage"))e.push(t);return e},Et.getSessionStorage=function(e,t){var n=Et._getSessionStorageObject();if(null!==n)try{return n.getItem(t)}catch(r){Et._canUseSessionStorage=!1,e.throwInternal(V.WARNING,ee,"Browser failed read of session storage. "+Et.getExceptionName(r),{exception:Et.dump(r)})}return null},Et.setSessionStorage=function(e,t,n){var r=Et._getSessionStorageObject();if(null!==r)try{return r.setItem(t,n),!0}catch(i){Et._canUseSessionStorage=!1,e.throwInternal(V.WARNING,ne,"Browser failed write to session storage. "+Et.getExceptionName(i),{exception:Et.dump(i)})}return!1},Et.removeSessionStorage=function(e,t){var n=Et._getSessionStorageObject();if(null!==n)try{return n.removeItem(t),!0}catch(r){Et._canUseSessionStorage=!1,e.throwInternal(V.WARNING,ie,"Browser failed removal of session storage item. "+Et.getExceptionName(r),{exception:Et.dump(r)})}return!1},Et.disableCookies=function(){K.disableCookies()},Et.canUseCookies=function(e){if(K._canUseCookies===undefined){K._canUseCookies=!1;try{K._canUseCookies=Et.document.cookie!==undefined}catch(t){e.throwInternal(V.WARNING,Le,"Cannot access document.cookie - "+Et.getExceptionName(t),{exception:Et.dump(t)})}}return K._canUseCookies},Et.disallowsSameSiteNone=function(e){return!!Ct(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",r=(t=e).length,i=r-n.length,t.substring(0<=i?i:0,r)===n)||-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11"));var t,n,r,i},Et.setCookie=function(e,t,n,r){var i,a,s;Et.canUseCookies(e)&&(a=i="",r&&(i=";domain="+r),(s=typeof location===I&&location?location:E("location"))&&"https:"===s.protocol&&(a=";secure",null===Nt&&(Nt=Et.disallowsSameSiteNone((R()||{}).userAgent)),Nt||(n+=";SameSite=None")),Et.document.cookie=t+"="+n+i+";path=/"+a)},Et.stringToBoolOrDefault=function(e,t){return void 0===t&&(t=!1),e===undefined||null===e?t:"true"===e.toString().toLowerCase()},Et.getCookie=function(e,t){if(Et.canUseCookies(e)){var n="";if(t&&t.length)for(var r=t+"=",i=Et.document.cookie.split(";"),a=0;a<i.length;a++){var s=i[a];if((s=Et.trim(s))&&0===s.indexOf(r)){n=s.substring(r.length,i[a].length);break}}return n}},Et.deleteCookie=function(e,t){Et.canUseCookies(e)&&(Et.document.cookie=t+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Et.newId=function(){for(var e="",t=1073741824*Math.random();0<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t%64),t=Math.floor(t/64);return e},Et.random32=function(){return 4294967296*Math.random()|0},Et.generateW3CId=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Et.random32())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+4*Math.random()|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)},Et.isArray=function(e){return"[object Array]"===Object[S].toString.call(e)},Et.isError=function(e){return"[object Error]"===Object[S].toString.call(e)},Et.getIEVersion=function(e){void 0===e&&(e=null);var t=e?e.toLowerCase():bt?(bt.userAgent||"").toLowerCase():"";if(-1!==t.indexOf("msie"))return parseInt(t.split("msie")[1]);if(t.indexOf("trident/")){var n=parseInt(t.split("trident/")[1]);if(n)return n+4}return null},Et.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,r=""+Math.floor(e/6e4)%60,i=""+Math.floor(e/36e5)%24,a=Math.floor(e/864e5),t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r;return(0<a?a+".":"")+(i=i.length<2?"0"+i:i)+":"+r+":"+n+"."+t},Et.isCrossOriginError=function(e,t,n,r,i){return("Script error."===e||"Script error"===e)&&!i},Et.dump=function(e){var t=Object[S].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":L()&&(n=M().stringify(e)),t+n},Et.getExceptionName=function(e){return"[object Error]"===Object[S].toString.call(e)?e.name:""},Et.addEventHandler=function(e,t){return Q.Attach(A(),e,t)},Et.IsBeaconApiSupported=function(){return"sendBeacon"in bt&&bt.sendBeacon},Et.getExtension=function(e,t){for(var n=null,r=0;!n&&r<e.length;)e[r]&&e[r].identifier===t&&(n=e[r]),r++;return n},Et.document=D()||{},Et._canUseLocalStorage=undefined,Et._canUseSessionStorage=undefined,Et._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Et.NotSpecified="not_specified",Et.trim=K.strTrim,Et.isDate=K.isDate,Et.toISOStringForIE8=K.toISOString,Et);function Et(){}var Tt=(At.parseUrl=function(e){var t=At._htmlAnchorIdx,n=At._htmlAnchorElement,r=n[t];return At.document.createElement?n[t]||(r=n[t]=At.document.createElement("a")):r={host:At.parseHost(e,!0)},r.href=e,++t>=n.length&&(t=0),At._htmlAnchorIdx=t,r},At.getAbsoluteUrl=function(e){var t,n=At.parseUrl(e);return n&&(t=n.href),t},At.getPathName=function(e){var t,n=At.parseUrl(e);return n&&(t=n.pathname),t},At.getCompleteUrl=function(e,t){return e?e.toUpperCase()+" "+t:t},At.parseHost=function(e,t){var n=At.parseFullHost(e,t);if(n){var r=n.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=r&&3<r.length&&Ct(r[2])&&0<r[2].length)return r[2]+(r[3]||"")}return n},At.parseFullHost=function(e,t){var n,r,i,a=null;return!e||null!=(n=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i))&&2<n.length&&Ct(n[2])&&0<n[2].length&&(a=n[2]||"",t&&2<n.length&&(r=(n[1]||"").toLowerCase(),i=n[3]||"",("http"===r&&":80"===i||"https"===r&&":443"===i)&&(i=""),a+=i)),a},At.document=D()||{},At._htmlAnchorIdx=0,At._htmlAnchorElement=[null,null,null,null,null],At);function At(){}var Dt=(Rt.ParseDependencyPath=function(e,t,n,r){var i,a,s,o=r,l=r;return o=t&&0<t.length?(s=(i=Tt.parseUrl(t)).host,o||(null!=i.pathname?("/"!==(a=0===i.pathname.length?"/":i.pathname).charAt(0)&&(a="/"+a),l=i.pathname,St.sanitizeString(e,n?n+" "+a:a)):St.sanitizeString(e,t))):s=r,{target:s,name:o,data:l}},Rt);function Rt(){}var Lt,Mt="sampleRate",Ut="ProcessLegacy",Ot="http.method",Pt=(Lt=function(){},__extends(zt,Lt),zt);function zt(){return Lt.call(this)||this}var kt,Ft=(kt=function(){this.ver=1,this.sampleRate=100,this.tags={}},__extends(Bt,kt),Bt);function Bt(e,t,n){var r=kt.call(this)||this;return r.name=St.sanitizeString(e,n)||wt.NotSpecified,r.data=t,r.time=K.toISOString(new Date),r.aiDataContract={time:h.Required,iKey:h.Required,name:h.Required,sampleRate:function(){return 100===r.sampleRate?h.Hidden:h.Required},tags:h.Required,data:h.Required},r}var qt,Gt=function(){},jt=(qt=Gt,__extends(Ht,qt),Ht);function Ht(){var e=qt.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var Xt,Kt=(Xt=jt,__extends(Wt,Xt),Wt.envelopeType="Microsoft.ApplicationInsights.{0}.Event",Wt.dataType="EventData",Wt);function Wt(e,t,n,r){var i=Xt.call(this)||this;return i.aiDataContract={ver:h.Required,name:h.Required,properties:h.Default,measurements:h.Default},i.name=St.sanitizeString(e,t)||wt.NotSpecified,i.properties=St.sanitizeProperties(e,n),i.measurements=St.sanitizeMeasurements(e,r),i}var Vt,Yt=function(){},Jt=(Vt=Gt,__extends(Qt,Vt),Qt);function Qt(){var e=Vt.call(this)||this;return e.ver=2,e.exceptions=[],e.properties={},e.measurements={},e}var Zt,$t=function(){this.hasFullStack=!0,this.parsedStack=[]},en=(Zt=Jt,__extends(tn,Zt),tn.CreateFromInterface=function(t,e){var n=e.exceptions&&K.arrMap(e.exceptions,function(e){return rn.CreateFromInterface(t,e)});return new tn(t,__assign({},e,{exceptions:n}))},tn.prototype.toInterface=function(){var e=this,t=e.exceptions,n=e.properties,r=e.measurements,i=e.severityLevel,a=(e.ver,e.problemGroup),s=e.id,o=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&K.arrMap(t,function(e){return e.toInterface()})||undefined,severityLevel:i,properties:n,measurements:r,problemGroup:a,id:s,isManual:o}},tn.CreateSimpleException=function(e,t,n,r,i,a){return{exceptions:[{hasFullStack:!0,message:e,stack:i,typeName:t}]}},tn.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",tn.dataType="ExceptionData",tn);function tn(e,t,n,r,i,a){var s=Zt.call(this)||this;return s.aiDataContract={ver:h.Required,exceptions:h.Required,severityLevel:h.Default,properties:h.Default,measurements:h.Default},t instanceof Error?(s.exceptions=[new rn(e,t)],s.properties=St.sanitizeProperties(e,n),s.measurements=St.sanitizeMeasurements(e,r),i&&(s.severityLevel=i),a&&(s.id=a)):(s.exceptions=t.exceptions,s.properties=t.properties,s.measurements=t.measurements,t.severityLevel&&(s.severityLevel=t.severityLevel),t.id&&(s.id=t.id),t.problemGroup&&(s.problemGroup=t.problemGroup),s.ver=2,K.isNullOrUndefined(t.isManual)||(s.isManual=t.isManual)),s}var nn,rn=(nn=$t,__extends(an,nn),an.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&K.arrMap(this.parsedStack,function(e){return e.toInterface()});return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||undefined}},an.CreateFromInterface=function(e,t){var n=t.parsedStack instanceof Array&&K.arrMap(t.parsedStack,function(e){return on.CreateFromInterface(e)})||t.parsedStack;return new an(e,__assign({},t,{parsedStack:n}))},an.parseStack=function(e){if(K.isString(e)){for(var t=e.split("\n"),n=[],r=0,i=0,a=0;a<=t.length;a++){var s,o=t[a];on.regex.test(o)&&(i+=(s=new on(t[a],r++)).sizeInBytes,n.push(s))}if(32768<i)for(var l=0,u=n.length-1,c=0,d=l,f=u;l<u;){if(32768<(c+=n[l].sizeInBytes+n[u].sizeInBytes)){var p=f-d+1;n.splice(d,p);break}d=l,f=u,l++,u--}}return n},an);function an(e,t){var n,r=nn.call(this)||this;return r.aiDataContract={id:h.Default,outerId:h.Default,typeName:h.Required,message:h.Required,hasFullStack:h.Default,stack:h.Default,parsedStack:h.Array},t instanceof Error?(r.typeName=St.sanitizeString(e,t.name)||wt.NotSpecified,r.message=St.sanitizeMessage(e,t.message)||wt.NotSpecified,n=t.stack,r.parsedStack=an.parseStack(n),r.stack=St.sanitizeException(e,n),r.hasFullStack=wt.isArray(r.parsedStack)&&0<r.parsedStack.length):(r.typeName=t.typeName,r.message=t.message,r.stack=t.stack,r.parsedStack=t.parsedStack,r.hasFullStack=t.hasFullStack),r}var sn,on=(sn=Yt,__extends(ln,sn),ln.CreateFromInterface=function(e){return new ln(e,null)},ln.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},ln.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,ln.baseSize=58,ln);function ln(e,t){var n,r,i=sn.call(this)||this;return i.sizeInBytes=0,i.aiDataContract={level:h.Required,method:h.Required,assembly:h.Default,fileName:h.Default,line:h.Default},"string"==typeof e?(n=e,i.level=t,i.method="<no_method>",i.assembly=wt.trim(n),i.fileName="",i.line=0,(r=n.match(ln.regex))&&5<=r.length&&(i.method=wt.trim(r[2])||i.method,i.fileName=wt.trim(r[4]),i.line=parseInt(r[5])||0)):(i.level=e.level,i.method=e.method,i.assembly=e.assembly,i.fileName=e.fileName,i.line=e.line,i.sizeInBytes=0),i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=ln.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}var un,cn,dn,fn=(un=Gt,__extends(pn,un),pn);function pn(){var e=un.call(this)||this;return e.ver=2,e.metrics=[],e.properties={},e.measurements={},e}(dn=cn=cn||{})[dn.Measurement=0]="Measurement",dn[dn.Aggregation=1]="Aggregation";var hn,gn=(hn=function(){this.kind=cn.Measurement},__extends(mn,hn),mn);function mn(){var e=null!==hn&&hn.apply(this,arguments)||this;return e.aiDataContract={name:h.Required,kind:h.Default,value:h.Required,count:h.Default,min:h.Default,max:h.Default,stdDev:h.Default},e}var vn,_n=(vn=fn,__extends(yn,vn),yn.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",yn.dataType="MetricData",yn);function yn(e,t,n,r,i,a,s,o){var l=vn.call(this)||this;l.aiDataContract={ver:h.Required,metrics:h.Required,properties:h.Default};var u=new gn;return u.count=0<r?r:undefined,u.max=isNaN(a)||null===a?undefined:a,u.min=isNaN(i)||null===i?undefined:i,u.name=St.sanitizeString(e,t)||wt.NotSpecified,u.value=n,l.metrics=[u],l.properties=St.sanitizeProperties(e,s),l.measurements=St.sanitizeMeasurements(e,o),l}var In,Sn=(In=jt,__extends(xn,In),xn);function xn(){var e=In.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var bn,Cn=(bn=Sn,__extends(Nn,bn),Nn.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",Nn.dataType="PageviewData",Nn);function Nn(e,t,n,r,i,a,s){var o=bn.call(this)||this;return o.aiDataContract={ver:h.Required,name:h.Default,url:h.Default,duration:h.Default,properties:h.Default,measurements:h.Default,id:h.Default},o.id=St.sanitizeId(e,s),o.url=St.sanitizeUrl(e,n),o.name=St.sanitizeString(e,t)||wt.NotSpecified,isNaN(r)||(o.duration=wt.msToTimeSpan(r)),o.properties=St.sanitizeProperties(e,i),o.measurements=St.sanitizeMeasurements(e,a),o}var wn,En=(wn=Gt,__extends(Tn,wn),Tn);function Tn(){var e=wn.call(this)||this;return e.ver=2,e.success=!0,e.properties={},e.measurements={},e}var An,Dn=(An=En,__extends(Rn,An),Rn.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",Rn.dataType="RemoteDependencyData",Rn);function Rn(e,t,n,r,i,a,s,o,l,u,c,d){void 0===l&&(l="Ajax");var f=An.call(this)||this;f.aiDataContract={id:h.Required,ver:h.Required,name:h.Default,resultCode:h.Default,duration:h.Default,success:h.Default,data:h.Default,target:h.Default,type:h.Default,properties:h.Default,measurements:h.Default,kind:h.Default,value:h.Default,count:h.Default,min:h.Default,max:h.Default,stdDev:h.Default,dependencyKind:h.Default,dependencySource:h.Default,commandName:h.Default,dependencyTypeName:h.Default},f.id=t,f.duration=wt.msToTimeSpan(i),f.success=a,f.resultCode=s+"",f.type=St.sanitizeString(e,l);var p=Dt.ParseDependencyPath(e,n,o,r);return f.data=St.sanitizeUrl(e,r)||p.data,f.target=St.sanitizeString(e,p.target),u&&(f.target=f.target+" | "+u),f.name=St.sanitizeString(e,p.name),f.properties=St.sanitizeProperties(e,c),f.measurements=St.sanitizeMeasurements(e,d),f}var Ln,Mn=(Ln=Gt,__extends(Un,Ln),Un);function Un(){var e=Ln.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var On,Pn=(On=Mn,__extends(zn,On),zn.envelopeType="Microsoft.ApplicationInsights.{0}.Message",zn.dataType="MessageData",zn);function zn(e,t,n,r,i){var a=On.call(this)||this;return a.aiDataContract={ver:h.Required,message:h.Required,severityLevel:h.Default,properties:h.Default},t=t||wt.NotSpecified,a.message=St.sanitizeMessage(e,t),a.properties=St.sanitizeProperties(e,r),a.measurements=St.sanitizeMeasurements(e,i),n&&(a.severityLevel=n),a}var kn,Fn=(kn=Sn,__extends(Bn,kn),Bn);function Bn(){var e=kn.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var qn,Gn=(qn=Fn,__extends(jn,qn),jn.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",jn.dataType="PageviewPerformanceData",jn);function jn(e,t,n,r,i,a,s){var o=qn.call(this)||this;return o.aiDataContract={ver:h.Required,name:h.Default,url:h.Default,duration:h.Default,perfTotal:h.Default,networkConnect:h.Default,sentRequest:h.Default,receivedResponse:h.Default,domProcessing:h.Default,properties:h.Default,measurements:h.Default},o.url=St.sanitizeUrl(e,n),o.name=St.sanitizeString(e,t)||wt.NotSpecified,o.properties=St.sanitizeProperties(e,i),o.measurements=St.sanitizeMeasurements(e,a),s&&(o.domProcessing=s.domProcessing,o.duration=s.duration,o.networkConnect=s.networkConnect,o.perfTotal=s.perfTotal,o.receivedResponse=s.receivedResponse,o.sentRequest=s.sentRequest),o}var Hn,Xn,Kn,Wn=(Hn=Pt,__extends(Vn,Hn),Vn);function Vn(e,t){var n=Hn.call(this)||this;return n.aiDataContract={baseType:h.Required,baseData:h.Required},n.baseType=e,n.baseData=t,n}(Kn=Xn=Xn||{})[Kn.Verbose=0]="Verbose",Kn[Kn.Information=1]="Information",Kn[Kn.Warning=2]="Warning",Kn[Kn.Error=3]="Error",Kn[Kn.Critical=4]="Critical";var Yn=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalSnippet="ai.internal.snippet",this.internalSdkSrc="ai.internal.sdkSrc"},Jn=new Yn,Qn=(Zn.prototype.enqueue=function(e){this._buffer.push(e)},Zn.prototype.count=function(){return this._buffer.length},Zn.prototype.clear=function(){this._buffer.length=0},Zn.prototype.getItems=function(){return this._buffer.slice(0)},Zn.prototype.batchPayloads=function(e){return e&&0<e.length?this._config.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},Zn.prototype.markAsSent=function(e){this.clear()},Zn.prototype.clearSent=function(e){},Zn);function Zn(e){this._config=e,this._buffer=[]}var $n=(er.prototype.enqueue=function(e){this._buffer.length>=er.MAX_BUFFER_SIZE?this._bufferFullMessageSent||(this._logger.throwInternal(V.WARNING,Re,"Maximum buffer size reached: "+this._buffer.length,!0),this._bufferFullMessageSent=!0):(this._buffer.push(e),this.setBuffer(er.BUFFER_KEY,this._buffer))},er.prototype.count=function(){return this._buffer.length},er.prototype.clear=function(){this._buffer.length=0,this.setBuffer(er.BUFFER_KEY,[]),this.setBuffer(er.SENT_BUFFER_KEY,[]),this._bufferFullMessageSent=!1},er.prototype.getItems=function(){return this._buffer.slice(0)},er.prototype.batchPayloads=function(e){return e&&0<e.length?this._config.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},er.prototype.markAsSent=function(e){this._buffer=this.removePayloadsFromBuffer(e,this._buffer),this.setBuffer(er.BUFFER_KEY,this._buffer);var t=this.getBuffer(er.SENT_BUFFER_KEY);t instanceof Array&&e instanceof Array&&((t=t.concat(e)).length>er.MAX_BUFFER_SIZE&&(this._logger.throwInternal(V.CRITICAL,Re,"Sent buffer reached its maximum size: "+t.length,!0),t.length=er.MAX_BUFFER_SIZE),this.setBuffer(er.SENT_BUFFER_KEY,t))},er.prototype.clearSent=function(e){var t=this.getBuffer(er.SENT_BUFFER_KEY),t=this.removePayloadsFromBuffer(e,t);this.setBuffer(er.SENT_BUFFER_KEY,t)},er.prototype.removePayloadsFromBuffer=function(e,t){var n=[];for(var r in t){var i=!1;for(var a in e)if(e[a]===t[r]){i=!0;break}i||n.push(t[r])}return n},er.prototype.getBuffer=function(e){var t=e;try{t=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+t:t;var n=wt.getSessionStorage(this._logger,t);if(n){var r=M().parse(n);if(r)return r}}catch(i){this._logger.throwInternal(V.CRITICAL,me," storage key: "+t+", "+wt.getExceptionName(i),{exception:wt.dump(i)})}return[]},er.prototype.setBuffer=function(e,t){var n=e;try{n=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+n:n;var r=JSON.stringify(t);wt.setSessionStorage(this._logger,n,r)}catch(i){wt.setSessionStorage(this._logger,n,JSON.stringify([])),this._logger.throwInternal(V.WARNING,ge," storage key: "+n+", "+wt.getExceptionName(i)+". Buffer cleared",{exception:wt.dump(i)})}},er.BUFFER_KEY="AI_buffer",er.SENT_BUFFER_KEY="AI_sentBuffer",er.MAX_BUFFER_SIZE=2e3,er);function er(e,t){this._bufferFullMessageSent=!1,this._logger=e,this._config=t;var n=this.getBuffer(er.BUFFER_KEY),r=this.getBuffer(er.SENT_BUFFER_KEY);this._buffer=n.concat(r),this._buffer.length>er.MAX_BUFFER_SIZE&&(this._buffer.length=er.MAX_BUFFER_SIZE),this.setBuffer(er.SENT_BUFFER_KEY,[]),this.setBuffer(er.BUFFER_KEY,this._buffer)}var tr=(nr.extractPropsAndMeasurements=function(e,t,n){if(!K.isNullOrUndefined(e))for(var r in e){var i;e.hasOwnProperty(r)&&(i=e[r],K.isNumber(i)?n[r]=i:K.isString(i)?t[r]=i:L()&&(t[r]=M().stringify(i)))}},nr.createEnvelope=function(e,t,n,r){var i=new Ft(e,r,t);n[Mt]&&(i.sampleRate=n[Mt]),i.iKey=n.iKey;var a=n.iKey.replace(/-/g,"");return i.name=i.name.replace("{0}",a),nr.extractPartAExtensions(n,i),n.tags||(n.tags=[]),i},nr.extractPartAExtensions=function(n,e){var t,r;e.tags||(e.tags={}),n.ext||(n.ext={}),n.tags||(n.tags=[]),n.ext.user&&(n.ext.user.authId&&(e.tags[Jn.userAuthUserId]=n.ext.user.authId),(t=n.ext.user.id||n.ext.user.localId)&&(e.tags[Jn.userId]=t)),n.ext.app&&n.ext.app.sesId&&(e.tags[Jn.sessionId]=n.ext.app.sesId),n.ext.device&&((n.ext.device.id||n.ext.device.localId)&&(e.tags[Jn.deviceId]=n.ext.device.id||n.ext.device.localId),n.ext.device.deviceClass&&(e.tags[Jn.deviceType]=n.ext.device.deviceClass),n.ext.device.ip&&(e.tags[Jn.deviceIp]=n.ext.device.ip)),n.ext.web&&((r=n.ext.web).browserLang&&(e.tags[Jn.deviceLanguage]=r.browserLang),r.browserVer&&(e.tags[Jn.deviceBrowserVersion]=r.browserVer),r.browser&&(e.tags[Jn.deviceBrowser]=r.browser),e.data=e.data||{},e.data.baseData=e.data.baseData||{},e.data.baseData.properties=e.data.baseData.properties||{},r.domain&&(e.data.baseData.properties.domain=r.domain),r.isManual&&(e.data.baseData.properties.isManual=r.isManual.toString()),r.screenRes&&(e.data.baseData.properties.screenRes=r.screenRes),r.userConsent&&(e.data.baseData.properties.userConsent=r.userConsent.toString())),n.ext.device&&n.ext.device.model&&(e.tags[Jn.deviceModel]=n.ext.device.model),n.ext.os&&n.ext.os.name&&(e.tags[Jn.deviceOS]=n.ext.os.name),n.ext.device&&n.ext.device.deviceType&&(e.tags[Jn.deviceType]=n.ext.device.deviceType),n.ext.trace&&(n.ext.trace.parentID&&(e.tags[Jn.operationParentId]=n.ext.trace.parentID),n.ext.trace.name&&(e.tags[Jn.operationName]=n.ext.trace.name),n.ext.trace.traceID&&(e.tags[Jn.operationId]=n.ext.trace.traceID));for(var i={},a=n.tags.length-1;0<=a;a--)!function(e){var t=n.tags[e];K.arrForEach(K.objKeys(t),function(e){i[e]=t[e]}),n.tags.splice(e,1)}(a);for(var s in n.tags)i[s]=n.tags[s];e.tags=__assign({},e.tags,i),e.tags[Jn.internalSdkVersion]||(e.tags[Jn.internalSdkVersion]="javascript:"+nr.Version)},nr.Version="2.5.5",nr);function nr(){}var rr,ir=(rr=tr,__extends(ar,rr),ar.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n=t.baseData.measurements||{},r=t.baseData.properties||{};tr.extractPropsAndMeasurements(t.data,r,n);var i=t.baseData;if(K.isNullOrUndefined(i))return e.warnToConsole("Invalid input for dependency data"),null;var a=i.id,s=i.target,o=i.name,l=i.duration,u=i.success,c=i.responseCode,d=i.type,f=i.correlationContext,p=i.properties&&i.properties[Ot]?i.properties[Ot]:"GET",h=new Dn(e,a,s,o,l,u,c,p,d,f,r,n),g=new Wn(Dn.dataType,h);return tr.createEnvelope(e,Dn.envelopeType,t,g)},ar.DependencyEnvelopeCreator=new ar,ar);function ar(){return null!==rr&&rr.apply(this,arguments)||this}var sr,or=(sr=tr,__extends(lr,sr),lr.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n={},r={};t.baseType!==Kt.dataType&&(n.baseTypeSource=t.baseType),t.baseType===Kt.dataType?(n=t.baseData.properties||{},r=t.baseData.measurements||{}):t.baseData&&tr.extractPropsAndMeasurements(t.baseData,n,r),tr.extractPropsAndMeasurements(t.data,n,r);var i=t.baseData.name,a=new Kt(e,i,n,r),s=new Wn(Kt.dataType,a);return tr.createEnvelope(e,Kt.envelopeType,t,s)},lr.EventEnvelopeCreator=new lr,lr);function lr(){return null!==sr&&sr.apply(this,arguments)||this}var ur,cr=(ur=tr,__extends(dr,ur),dr.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n=t.baseData,r=en.CreateFromInterface(e,n),i=new Wn(en.dataType,r);return tr.createEnvelope(e,en.envelopeType,t,i)},dr.ExceptionEnvelopeCreator=new dr,dr);function dr(){return null!==ur&&ur.apply(this,arguments)||this}var fr,pr=(fr=tr,__extends(hr,fr),hr.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n=t.baseData.properties||{},r=t.baseData.measurements||{};tr.extractPropsAndMeasurements(t.data,n,r);var i=t.baseData.name,a=t.baseData.average,s=t.baseData.sampleCount,o=t.baseData.min,l=t.baseData.max,u=new _n(e,i,a,s,o,l,n,r),c=new Wn(_n.dataType,u);return tr.createEnvelope(e,_n.envelopeType,t,c)},hr.MetricEnvelopeCreator=new hr,hr);function hr(){return null!==fr&&fr.apply(this,arguments)||this}var gr,mr=(gr=tr,__extends(vr,gr),vr.prototype.Create=function(e,t){var n;this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null."),K.isNullOrUndefined(t.baseData)||K.isNullOrUndefined(t.baseData.properties)||K.isNullOrUndefined(t.baseData.properties.duration)?K.isNullOrUndefined(t.data)||K.isNullOrUndefined(t.data.duration)||(n=t.data.duration,delete t.data.duration):(n=t.baseData.properties.duration,delete t.baseData.properties.duration);var r,i=t.baseData;t.ext&&t.ext.trace&&t.ext.trace.traceID&&(r=t.ext.trace.traceID);var a=i.id||r,s=i.name,o=i.uri,l=i.properties||{},u=i.measurements||{};if(K.isNullOrUndefined(i.refUri)||(l.refUri=i.refUri),K.isNullOrUndefined(i.pageType)||(l.pageType=i.pageType),K.isNullOrUndefined(i.isLoggedIn)||(l.isLoggedIn=i.isLoggedIn.toString()),!K.isNullOrUndefined(i.properties)){var c=i.properties;for(var d in c)c.hasOwnProperty(d)&&(l[d]=c[d])}tr.extractPropsAndMeasurements(t.data,l,u);var f=new Cn(e,s,o,n,l,u,a),p=new Wn(Cn.dataType,f);return tr.createEnvelope(e,Cn.envelopeType,t,p)},vr.PageViewEnvelopeCreator=new vr,vr);function vr(){return null!==gr&&gr.apply(this,arguments)||this}var _r,yr=(_r=tr,__extends(Ir,_r),Ir.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n=t.baseData,r=n.name,i=n.uri||n.url,a=n.properties||{},s=n.measurements||{};tr.extractPropsAndMeasurements(t.data,a,s);var o=new Gn(e,r,i,undefined,a,s,n),l=new Wn(Gn.dataType,o);return tr.createEnvelope(e,Gn.envelopeType,t,l)},Ir.PageViewPerformanceEnvelopeCreator=new Ir,Ir);function Ir(){return null!==_r&&_r.apply(this,arguments)||this}var Sr,xr=(Sr=tr,__extends(br,Sr),br.prototype.Create=function(e,t){this._logger=e,K.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(V.CRITICAL,_e,"telemetryItem.baseData cannot be null.");var n=t.baseData.message,r=t.baseData.severityLevel,i=t.baseData.properties||{},a=t.baseData.measurements||{};tr.extractPropsAndMeasurements(t.data,i,a);var s=new Pn(e,n,r,i,a),o=new Wn(Pn.dataType,s);return tr.createEnvelope(e,Pn.envelopeType,t,o)},br.TraceEnvelopeCreator=new br,br);function br(){return null!==Sr&&Sr.apply(this,arguments)||this}var Cr=(Nr.prototype.serialize=function(e){var t=this._serializeObject(e,"root");try{return M().stringify(t)}catch(n){this._logger.throwInternal(V.CRITICAL,Ie,n&&K.isFunction(n.toString)?n.toString():"Error serializing object",null,!0)}},Nr.prototype._serializeObject=function(e,t){var n="__aiCircularRefCheck",r={};if(!e)return this._logger.throwInternal(V.CRITICAL,Ie,"cannot serialize object because it is null or undefined",{name:t},!0),r;if(e[n])return this._logger.throwInternal(V.WARNING,xe,"Circular reference detected while serializing object",{name:t},!0),r;if(!e.aiDataContract){if("measurements"===t)r=this._serializeStringMap(e,"number",t);else if("properties"===t)r=this._serializeStringMap(e,"string",t);else if("tags"===t)r=this._serializeStringMap(e,"string",t);else if(wt.isArray(e))r=this._serializeArray(e,t);else{this._logger.throwInternal(V.WARNING,Se,"Attempting to serialize an object which does not implement ISerializable",{name:t},!0);try{M().stringify(e),r=e}catch(f){this._logger.throwInternal(V.CRITICAL,Ie,f&&K.isFunction(f.toString)?f.toString():"Error serializing object",null,!0)}}return r}for(var i in e[n]=!0,e.aiDataContract){var a,s=e.aiDataContract[i],o=K.isFunction(s)?s()&h.Required:s&h.Required,l=K.isFunction(s)?s()&h.Hidden:s&h.Hidden,u=s&h.Array,c=e[i]!==undefined,d=K.isObject(e[i])&&null!==e[i];!o||c||u?l||(a=void 0,(a=d?u?this._serializeArray(e[i],i):this._serializeObject(e[i],i):e[i])!==undefined&&(r[i]=a)):this._logger.throwInternal(V.CRITICAL,ce,"Missing required field specification. The field is required but not present on source",{field:i,name:t})}return delete e[n],r},Nr.prototype._serializeArray=function(e,t){var n;if(e)if(wt.isArray(e)){n=[];for(var r=0;r<e.length;r++){var i=e[r],a=this._serializeObject(i,t+"["+r+"]");n.push(a)}}else this._logger.throwInternal(V.CRITICAL,Ce,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:t},!0);return n},Nr.prototype._serializeStringMap=function(e,t,n){var r;if(e)for(var i in r={},e){var a,s=e[i];"string"===t?s===undefined?r[i]="undefined":null===s?r[i]="null":s.toString?r[i]=s.toString():r[i]="invalid field: toString() is not defined.":"number"===t?s===undefined?r[i]="undefined":null===s?r[i]="null":(a=parseFloat(s),isNaN(a)?r[i]="NaN":r[i]=a):(r[i]="invalid field: "+n+" is of unknown type.",this._logger.throwInternal(V.CRITICAL,r[i],null,!0))}return r},Nr);function Nr(e){this._logger=e}function wr(){this._onlineStatus=!0;var e,t=A(),n=D(),r=!1;try{t&&Q.Attach(t,"online",this._setOnline.bind(this))&&(Q.Attach(t,"offline",this._setOffline.bind(this)),r=!0),n&&(e=n.body||n,K.isUndefined(e.ononline)||(e.ononline=this._setOnline.bind(this),e.onoffline=this._setOffline.bind(this),r=!0))}catch(i){r=!1}this.isListening=r}var Er=(wr.prototype.isOnline=function(){var e=R();return this.isListening?this._onlineStatus:!(e&&!K.isNullOrUndefined(e.onLine))||e.onLine},wr.prototype.isOffline=function(){return!this.isOnline()},wr.prototype._setOnline=function(){this._onlineStatus=!0},wr.prototype._setOffline=function(){this._onlineStatus=!1},wr.Offline=new wr,wr).Offline,Tr=(Ar.prototype.getHashCodeScore=function(e){return this.getHashCode(e)/Ar.INT_MAX_VALUE*100},Ar.prototype.getHashCode=function(e){if(""===e)return 0;for(;e.length<Ar.MIN_INPUT_LENGTH;)e=e.concat(e);for(var t=5381,n=0;n<e.length;++n)t=(t<<5)+t+e.charCodeAt(n),t&=t;return Math.abs(t)},Ar.INT_MAX_VALUE=2147483647,Ar.MIN_INPUT_LENGTH=8,Ar);function Ar(){}var Dr=(Rr.prototype.getSamplingScore=function(e){return e.tags&&e.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):100*Math.random()},Rr);function Rr(){this.hashCodeGeneragor=new Tr,this.keys=new Yn}var Lr=(Mr.prototype.isSampledIn=function(e){var t=this.sampleRate;return null===t||t===undefined||100<=t||e.baseType===_n.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t},Mr);function Mr(e,t){this.INT_MAX_VALUE=2147483647,this._logger=K.isNullOrUndefined(t)?new Fe:t,(100<e||e<0)&&(this._logger.throwInternal(V.WARNING,Ee,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),this.sampleRate=100),this.sampleRate=e,this.samplingScoreGenerator=new Dr}function Ur(e){try{return e.responseText}catch(t){}return null}var Or,Pr=(Or=Ve,__extends(zr,Or),zr.constructEnvelope=function(e,t,n){var r=t===e.iKey||K.isNullOrUndefined(t)?e:__assign({},e,{iKey:t});switch(r.baseType){case Kt.dataType:return or.EventEnvelopeCreator.Create(n,r);case Pn.dataType:return xr.TraceEnvelopeCreator.Create(n,r);case Cn.dataType:return mr.PageViewEnvelopeCreator.Create(n,r);case Gn.dataType:return yr.PageViewPerformanceEnvelopeCreator.Create(n,r);case en.dataType:return cr.ExceptionEnvelopeCreator.Create(n,r);case _n.dataType:return pr.MetricEnvelopeCreator.Create(n,r);case Dn.dataType:return ir.DependencyEnvelopeCreator.Create(n,r);default:return or.EventEnvelopeCreator.Create(n,r)}},zr._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){return undefined},namePrefix:function(){return undefined},samplingPercentage:function(){return 100}}},zr._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:undefined,emitLineDelimitedJson:undefined,maxBatchInterval:undefined,maxBatchSizeInBytes:undefined,disableTelemetry:undefined,enableSessionStorageBuffer:undefined,isRetryDisabled:undefined,isBeaconApiDisabled:undefined,onunloadDisableBeacon:undefined,instrumentationKey:undefined,namePrefix:undefined,samplingPercentage:undefined}},zr.prototype.pause=function(){throw new Error("Method not implemented.")},zr.prototype.resume=function(){throw new Error("Method not implemented.")},zr.prototype.flush=function(){try{this.triggerSend(!0,null,1)}catch(e){this.diagLog().throwInternal(V.CRITICAL,le,"flush failed, telemetry will not be collected: "+wt.getExceptionName(e),{exception:wt.dump(e)})}},zr.prototype.onunloadFlush=function(){if(!1!==this._senderConfig.onunloadDisableBeacon()&&!1!==this._senderConfig.isBeaconApiDisabled()||!wt.IsBeaconApiSupported())this.flush();else try{this.triggerSend(!0,this._beaconSender,2)}catch(e){this.diagLog().throwInternal(V.CRITICAL,oe,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+wt.getExceptionName(e),{exception:wt.dump(e)})}},zr.prototype.teardown=function(){throw new Error("Method not implemented.")},zr.prototype.initialize=function(e,t,n,r){Or.prototype.initialize.call(this,e,t,n,r);var i=this._getTelCtx(),a=this.identifier;this._serializer=new Cr(t.logger),this._notificationManager=((e||{}).extensionConfig||{}).NotificationManager,this._consecutiveErrors=0,this._retryAt=null,this._lastSend=0,this._sender=null;var s=zr._getDefaultAppInsightsChannelConfig();this._senderConfig=zr._getEmptyAppInsightsChannelConfig();var o=this;for(var l in s)!function(e){o._senderConfig[e]=function(){return i.getConfig(a,e,s[e]())}}(l);this._buffer=this._senderConfig.enableSessionStorageBuffer&&wt.canUseSessionStorage()?new $n(this.diagLog(),this._senderConfig):new Qn(this._senderConfig),this._sample=new Lr(this._senderConfig.samplingPercentage(),this.diagLog()),!this._senderConfig.isBeaconApiDisabled()&&wt.IsBeaconApiSupported()?this._sender=this._beaconSender:K.isUndefined(XMLHttpRequest)||("withCredentials"in new XMLHttpRequest?(this._sender=this._xhrSender,this._XMLHttpRequestSupported=!0):K.isUndefined(XDomainRequest)||(this._sender=this._xdrSender))},zr.prototype.processTelemetry=function(e,n){n=this._getTelCtx(n);try{if(this._senderConfig.disableTelemetry())return;if(!e)return void n.diagLog().throwInternal(V.CRITICAL,ae,"Cannot send empty telemetry");if(e.baseData&&!e.baseType)return void n.diagLog().throwInternal(V.CRITICAL,Ue,"Cannot send telemetry without baseData and baseType");if(e.baseType||(e.baseType="EventData"),!this._sender)return void n.diagLog().throwInternal(V.CRITICAL,fe,"Sender was not initialized");if(!this._isSampledIn(e))return void n.diagLog().throwInternal(V.WARNING,pe,"Telemetry item was sampled out and not sent",{SampleRate:this._sample.sampleRate});e[Mt]=this._sample.sampleRate;var r=zr.constructEnvelope(e,this._senderConfig.instrumentationKey(),n.diagLog());if(!r)return void n.diagLog().throwInternal(V.CRITICAL,ye,"Unable to create an AppInsights envelope");var i=!1;if(e.tags&&e.tags[Ut]&&(K.arrForEach(e.tags[Ut],function(e){try{e&&!1===e(r)&&(i=!0,n.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(t){n.diagLog().throwInternal(V.CRITICAL,Ae,"One of telemetry initializers failed, telemetry item will not be sent: "+wt.getExceptionName(t),{exception:wt.dump(t)},!0)}}),delete e.tags[Ut]),i)return;var t=this._serializer.serialize(r),a=this._buffer.getItems(),s=this._buffer.batchPayloads(a);s&&s.length+t.length>this._senderConfig.maxBatchSizeInBytes()&&this.triggerSend(!0,null,10),this._buffer.enqueue(t),this._setupTimer()}catch(o){n.diagLog().throwInternal(V.WARNING,se,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+wt.getExceptionName(o),{exception:wt.dump(o)})}this.processNext(e,n)},zr.prototype._xhrReadyStateChange=function(e,t,n){var r;4===e.readyState&&(r=null,this._appId||(r=this._parseResponse(Ur(e)||e.response))&&r.appId&&(this._appId=r.appId),(e.status<200||300<=e.status)&&0!==e.status?!this._senderConfig.isRetryDisabled()&&this._isRetriable(e.status)?(this._resendPayload(t),this.diagLog().throwInternal(V.WARNING,he,". Response code "+e.status+". Will retry to send "+t.length+" items.")):this._onError(t,this._formatErrorMessageXhr(e)):Er.isOffline()?this._senderConfig.isRetryDisabled()||(this._resendPayload(t,10),this.diagLog().throwInternal(V.WARNING,he,". Offline - Response Code: "+e.status+". Offline status: "+Er.isOffline()+". Will retry to send "+t.length+" items.")):206===e.status?(r=r||this._parseResponse(Ur(e)||e.response))&&!this._senderConfig.isRetryDisabled()?this._onPartialSuccess(t,r):this._onError(t,this._formatErrorMessageXhr(e)):(this._consecutiveErrors=0,this._onSuccess(t,n)))},zr.prototype.triggerSend=function(e,t,n){void 0===e&&(e=!0);try{var r;this._senderConfig.disableTelemetry()?this._buffer.clear():(0<this._buffer.count()&&(r=this._buffer.getItems(),this._notifySendRequest(n||0,e),t?t.call(this,r,e):this._sender(r,e)),this._lastSend=+new Date),clearTimeout(this._timeoutHandle),this._timeoutHandle=null,this._retryAt=null}catch(a){var i=wt.getIEVersion();(!i||9<i)&&this.diagLog().throwInternal(V.CRITICAL,he,"Telemetry transmission failed, some telemetry will be lost: "+wt.getExceptionName(a),{exception:wt.dump(a)})}},zr.prototype._onError=function(e,t,n){this.diagLog().throwInternal(V.WARNING,de,"Failed to send telemetry.",{message:t}),this._buffer.clearSent(e)},zr.prototype._onPartialSuccess=function(e,t){for(var n=[],r=[],i=0,a=t.errors.reverse();i<a.length;i++){var s=a[i],o=e.splice(s.index,1)[0];this._isRetriable(s.statusCode)?r.push(o):n.push(o)}0<e.length&&this._onSuccess(e,t.itemsAccepted),0<n.length&&this._onError(n,this._formatErrorMessageXhr(null,["partial success",t.itemsAccepted,"of",t.itemsReceived].join(" "))),0<r.length&&(this._resendPayload(r),this.diagLog().throwInternal(V.WARNING,he,"Partial success. Delivered: "+e.length+", Failed: "+n.length+". Will retry to send "+r.length+" our of "+t.itemsReceived+" items"))},zr.prototype._onSuccess=function(e,t){this._buffer.clearSent(e)},zr.prototype._xdrOnLoad=function(e,t){var n,r=Ur(e);!e||r+""!="200"&&""!==r?(n=this._parseResponse(r))&&n.itemsReceived&&n.itemsReceived>n.itemsAccepted&&!this._senderConfig.isRetryDisabled()?this._onPartialSuccess(t,n):this._onError(t,this._formatErrorMessageXdr(e)):(this._consecutiveErrors=0,this._onSuccess(t,0))},zr.prototype._isSampledIn=function(e){return this._sample.isSampledIn(e)},zr.prototype._beaconSender=function(e,t){var n=this._senderConfig.endpointUrl(),r=this._buffer.batchPayloads(e),i=new Blob([r],{type:"text/plain;charset=UTF-8"});R().sendBeacon(n,i)?(this._buffer.markAsSent(e),this._onSuccess(e,e.length)):(this._xhrSender(e,!0),this.diagLog().throwInternal(V.WARNING,he,". Failed to send telemetry with Beacon API, retried with xhrSender."))},zr.prototype._xhrSender=function(t,e){var n=this,r=new XMLHttpRequest,i=this._senderConfig.endpointUrl();try{r.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(s){}r.open("POST",i,e),r.setRequestHeader("Content-type","application/json"),wt.isInternalApplicationInsightsEndpoint(i)&&r.setRequestHeader(yt.sdkContextHeader,yt.sdkContextHeaderAppIdRequest),r.onreadystatechange=function(){return n._xhrReadyStateChange(r,t,t.length)},r.onerror=function(e){return n._onError(t,n._formatErrorMessageXhr(r),e)};var a=this._buffer.batchPayloads(t);r.send(a),this._buffer.markAsSent(t)},zr.prototype._parseResponse=function(e){try{if(e&&""!==e){var t=M().parse(e);if(t&&t.itemsReceived&&t.itemsReceived>=t.itemsAccepted&&t.itemsReceived-t.itemsAccepted===t.errors.length)return t}}catch(n){this.diagLog().throwInternal(V.CRITICAL,ve,"Cannot parse the response. "+wt.getExceptionName(n),{response:e})}return null},zr.prototype._resendPayload=function(e,t){if(void 0===t&&(t=1),e&&0!==e.length){this._buffer.clearSent(e),this._consecutiveErrors++;for(var n=0,r=e;n<r.length;n++){var i=r[n];this._buffer.enqueue(i)}this._setRetryTime(t),this._setupTimer()}},zr.prototype._setRetryTime=function(e){var t,n,r=this._consecutiveErrors<=1?10:(t=(Math.pow(2,this._consecutiveErrors)-1)/2,n=Math.floor(Math.random()*t*10)+1,n*=e,Math.max(Math.min(n,3600),10)),i=Date.now()+1e3*r;this._retryAt=i},zr.prototype._setupTimer=function(){var e,t,n=this;this._timeoutHandle||(e=this._retryAt?Math.max(0,this._retryAt-Date.now()):0,t=Math.max(this._senderConfig.maxBatchInterval(),e),this._timeoutHandle=setTimeout(function(){n.triggerSend(!0,null,1)},t))},zr.prototype._isRetriable=function(e){return 408===e||429===e||500===e||503===e},zr.prototype._formatErrorMessageXhr=function(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+Ur(e)||e.response||"":t},zr.prototype._xdrSender=function(t,e){var n=this,r=A(),i=new XDomainRequest;i.onload=function(){return n._xdrOnLoad(i,t)},i.onerror=function(e){return n._onError(t,n._formatErrorMessageXdr(i),e)};var a=r&&r.location&&r.location.protocol||"";if(0!==this._senderConfig.endpointUrl().lastIndexOf(a,0))return this.diagLog().throwInternal(V.WARNING,he,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void this._buffer.clear();var s=this._senderConfig.endpointUrl().replace(/^(https?:)/,"");i.open("POST",s);var o=this._buffer.batchPayloads(t);i.send(o),this._buffer.markAsSent(t)},zr.prototype._formatErrorMessageXdr=function(e,t){return e?"XDomainRequest,Response:"+Ur(e)||"":t},zr.prototype._notifySendRequest=function(e,t){var n=this._notificationManager;if(n&&n.eventsSendRequest)try{n.eventsSendRequest(e,t)}catch(r){this.diagLog().throwInternal(V.CRITICAL,Pe,"send request notification failed: "+wt.getExceptionName(r),{exception:wt.dump(r)})}},zr);function zr(){var e=null!==Or&&Or.apply(this,arguments)||this;return e.priority=1001,e.identifier="AppInsightsChannelPlugin",e._XMLHttpRequestSupported=!1,e}e.Sender=Pr,function(e,t,n){var r=Object.defineProperty;if(r)try{return r(e,t,n)}catch(i){}typeof n.value!==undefined&&(e[t]=n.value)}(e,"__esModule",{value:!0})});
//# sourceMappingURL=applicationinsights-channel-js.min.js.map
